(this.webpackJsonpStrangersThings2=this.webpackJsonpStrangersThings2||[]).push([[0],{35:function(e,t,r){"use strict";r.r(t);var n=r(7),s=r(3),c=r(1),a=r(20),o=r.n(a),i=r(0),l=function(){return Object(i.jsxs)("div",{id:"title",className:"jumbotron text-center",children:[Object(i.jsx)("h1",{className:"text-info",children:"STRANGER'S THINGS"}),Object(i.jsx)("h5",{className:"text-warning",children:"Developed by Derek Miller"})]})},u=r(2),p=r.n(u),j=r(5),b=function(){var e=Object(j.a)(p.a.mark((function e(t){var r,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/posts",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}});case 3:return r=e.sent,e.next=6,r.json();case 6:if(!(n=e.sent).error){e.next=9;break}throw n.error;case 9:return console.log(n),e.abrupt("return",n.data.posts);case 13:e.prev=13,e.t0=e.catch(0),console.error("Trouble fetching posts",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(j.a)(p.a.mark((function e(t,r,n,s){var c,a,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n===s){e.next=4;break}return alert("PASSWORDS DON'T MATCH!"),e.abrupt("return");case 4:return e.next=6,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:r,password:n}})});case 6:return c=e.sent,e.next=9,c.json();case 9:if(a=e.sent,o=a.data.token,console.log("fetch new user",a),t(o),localStorage.setItem("token",o),!a.error){e.next=16;break}throw a.error;case 16:console.log(a),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.error("Trouble registering",e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t,r,n,s){return e.apply(this,arguments)}}(),d=function(){var e=Object(j.a)(p.a.mark((function e(t,r,n){var s,c,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:t,password:r}})});case 3:return s=e.sent,e.next=6,s.json();case 6:if(c=e.sent,console.log(c.data.token),a=c.data.token,n(a),localStorage.setItem("token",a),localStorage.getItem("token"),!c.error){e.next=14;break}throw c.error;case 14:console.log(c),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.error("Trouble logging in",e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t,r,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(j.a)(p.a.mark((function e(t,r,n,s,c,a){var o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/posts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({post:{title:r,description:n,location:a,price:s,willDeliver:c}})});case 3:return o=e.sent,e.next=6,o.json();case 6:if(!(i=e.sent).error){e.next=9;break}throw i.error;case 9:return console.log(i),e.abrupt("return",i.data.post);case 13:e.prev=13,e.t0=e.catch(0),console.error("Trouble with posting the new post",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,r,n,s,c,a){return e.apply(this,arguments)}}(),x=function(){var e=Object(j.a)(p.a.mark((function e(t){var r,n,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/users/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}});case 3:return r=e.sent,e.next=6,r.json();case 6:return n=e.sent,s=n,console.log("user Data succesfull??",n),e.abrupt("return",s);case 12:e.prev=12,e.t0=e.catch(0),console.error("trouble fetching user data",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(j.a)(p.a.mark((function e(t,r){var n,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/posts/"+r,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}});case 3:return n=e.sent,e.next=6,n.json();case 6:s=e.sent,console.log(s),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Error deleting post",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,r){return e.apply(this,arguments)}}(),f=function(){var e=Object(j.a)(p.a.mark((function e(t,r,n){var s,c,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("ID",n),e.prev=1,e.next=4,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/posts/"+n+"/messages",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({message:{content:r}})});case 4:return s=e.sent,e.next=7,s.json();case 7:return c=e.sent,a=c.data.message._id,console.log("message data:",a),e.abrupt("return",c);case 13:e.prev=13,e.t0=e.catch(1),console.error("Trouble creating new message",e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,r,n){return e.apply(this,arguments)}}(),g=function(){var e=Object(j.a)(p.a.mark((function e(t){var r,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/test/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}});case 3:return r=e.sent,e.next=6,r.json();case 6:if(!(n=e.sent).error){e.next=9;break}throw n.error;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Trouble checking for valid token",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(j.a)(p.a.mark((function e(t){var r,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/users/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}});case 3:return r=e.sent,e.next=6,r.json();case 6:n=e.sent,console.log("User Logged in?",n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Trouble fetching info",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),k=function(e){var t=e.setToken,r=e.history,n=Object(c.useState)(""),a=Object(s.a)(n,2),o=a[0],l=a[1],u=Object(c.useState)(""),b=Object(s.a)(u,2),d=b[0],O=b[1],x=Object(c.useState)(""),m=Object(s.a)(x,2),f=m[0],g=m[1];return Object(i.jsxs)("form",{onSubmit:function(){var e=Object(j.a)(p.a.mark((function e(n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,h(t,o,d,f);case 4:e.sent,r.push("/login"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),children:[Object(i.jsx)("h3",{children:"Register"}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"Username"}),Object(i.jsx)("input",{onChange:function(e){return l(e.target.value)},type:"text",className:"form-control",placeholder:"Username",required:!0})]}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"Password"}),Object(i.jsx)("input",{onChange:function(e){return O(e.target.value)},type:"password",className:"form-control",placeholder:"Enter password",required:!0})]}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"Verify Password"}),Object(i.jsx)("input",{onChange:function(e){return g(e.target.value)},type:"password",className:"form-control",placeholder:"Verify password",required:!0})]}),Object(i.jsx)("button",{type:"submit",className:"btn btn-primary btn-dark btn-lg btn-block",children:"Register"})]})},N=r(9),y=function(e){var t=e.setToken,r=e.match,n=e.history,a=Object(c.useState)(""),o=Object(s.a)(a,2),l=o[0],u=o[1],p=Object(c.useState)(""),j=Object(s.a)(p,2),b=j[0],O=j[1],x=Object(c.useState)(""),m=Object(s.a)(x,2),f=m[0],g=m[1];return Object(i.jsxs)("form",{onSubmit:function(e){e.preventDefault(),"/register"===r.url&&h(t,l,b,f),n.push("/login"),"/login"===r.url&&(console.log(l,b,f),d(l,b,t)),n.push("/posts")},children:[Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"Username"}),Object(i.jsx)("input",{onChange:function(e){var t=e.target.value;return u(t)},type:"text",className:"form-control",placeholder:"Username",required:!0})]}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"Password"}),Object(i.jsx)("input",{onChange:function(e){var t=e.target.value;return O(t)},type:"password",className:"form-control",placeholder:"Enter password",required:!0})]}),"/register"===r.url?Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"Verify Password"}),Object(i.jsx)("input",{onChange:function(e){var t=e.target.value;return g(t)},type:"password",value:f,className:"form-control",placeholder:"Verify password",required:!0})]}):null,Object(i.jsx)("button",{type:"submit",className:"btn btn-primary btn-dark btn-lg btn-block",children:"Login"}),"/register"===r.url?Object(i.jsx)(N.b,{to:"login",children:" Already have an account?"}):Object(i.jsx)(N.b,{to:"register",children:" Don't have an account?"})]})},w=function(e){var t=e.token,r=e.setToken,n=e.history;return Object(i.jsx)("button",{onClick:function(e){var s=t;console.log("storage token is:",s),s&&(localStorage.removeItem("token"),r(null),n.push("/login"))},type:"submit",className:"btn btn-primary btn-dark btn-lg btn-block",children:"Logout"})},S=r(23),T=r(4),C=function(e){var t=e.posts,r=e.setPosts,n=e.token;e.isLoggedIn;Object(c.useEffect)(Object(j.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(n);case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)}))),[]),Object(c.useEffect)((function(){l(t)}),[t]);var a=Object(c.useState)([]),o=Object(s.a)(a,2),l=(o[0],o[1]);return Object(i.jsxs)("div",{className:"container",children:[Object(i.jsx)("h1",{className:"text-center",children:"Current Postings"}),Object(i.jsx)("br",{}),Object(i.jsx)(E,{setFilteredResults:l,posts:t}),Object(i.jsx)("br",{}),Object(i.jsx)("div",{children:t.map((function(e,t){return Object(i.jsxs)("div",{className:"containter",children:[Object(i.jsx)("h2",{className:"list-group-item-heading text-danger",children:e.title}),Object(i.jsxs)("div",{className:"list-group-item-info",children:["Posted by: ",e.author.username]}),Object(i.jsxs)("div",{className:"bg-success",children:["Description: ",e.description]}),Object(i.jsxs)("div",{className:"bg-success list-group-item-text",children:["Location: ",e.location]}),Object(i.jsxs)("div",{className:"list-group-item-text bg-success text-danger",children:["Price: ",e.price]}),Object(i.jsxs)("div",{className:"bg-success list-group-item-text",children:["Will Deliver: ",e.willDeliver]}),Object(i.jsx)("br",{}),n?Object(i.jsx)(D,{token:n,_id:e._id}):null]},t)}))})]})},P=function(e){var t=e.token,r=e.posts,n=e.setPosts,a=Object(c.useState)(""),o=Object(s.a)(a,2),l=o[0],u=o[1],b=Object(c.useState)(""),h=Object(s.a)(b,2),d=h[0],x=h[1],m=Object(c.useState)(""),f=Object(s.a)(m,2),g=f[0],v=f[1],k=Object(c.useState)(""),N=Object(s.a)(k,2),y=N[0],w=N[1],C=Object(c.useState)(""),P=Object(s.a)(C,2),D=P[0],E=P[1],R=Object(T.e)();return Object(i.jsxs)("form",{onSubmit:function(){var e=Object(j.a)(p.a.mark((function e(s){var c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.prev=1,e.next=4,O(t,l,d,g,y,D);case 4:c=e.sent,n([].concat(Object(S.a)(r),[c])),R.push("/posts"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),children:[Object(i.jsx)("h3",{children:"Make a new post"}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"Title"}),Object(i.jsx)("input",{onChange:function(e){return u(e.target.value)},type:"text",className:"form-control",placeholder:"Title",required:!0})]}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"Description"}),Object(i.jsx)("input",{onChange:function(e){return x(e.target.value)},type:"text",className:"form-control",placeholder:"Description",required:!0})]}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"Location"}),Object(i.jsx)("input",{onChange:function(e){return E(e.target.value)},type:"text",className:"form-control",placeholder:"Location",required:!0})]}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"Price"}),Object(i.jsx)("input",{onChange:function(e){return v(e.target.value)},type:"number",className:"form-control",placeholder:"Price",required:!0})]}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"Will deliver?"}),Object(i.jsx)("input",{onChange:function(e){return w(e.target.value)},type:"text",className:"form-control",placeholder:"Deliver?",required:!0})]}),Object(i.jsx)("button",{type:"submit",className:"btn btn-primary btn-block",children:"Create Post"})]})},D=function(e){var t=e.token,r=(e.content,e._id),n=Object(c.useState)(""),a=Object(s.a)(n,2),o=a[0],l=a[1],u=Object(T.e)();return Object(i.jsx)("form",{onSubmit:function(){var e=Object(j.a)(p.a.mark((function e(n){var s,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,f(t,o,r);case 4:s=e.sent,c=s.data.message.content,console.log(c),l(c),u.push("/posts"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),className:"form-group",children:Object(i.jsx)("div",{className:"col-lg-6",children:Object(i.jsxs)("div",{className:"input-group",children:[Object(i.jsx)("input",{onChange:function(e){var t=e.target.value;return l(t)},type:"text",className:"form-control",placeholder:"Write message here...",required:!0}),Object(i.jsx)("span",{className:"input-group-btn",children:Object(i.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Send"})})]})})})},E=function(e){var t=e.setFilteredResults,r=e.posts;var n=Object(c.useState)(""),a=Object(s.a)(n,2),o=a[0],l=a[1];return Object(i.jsx)("form",{className:"form-group",children:Object(i.jsx)("div",{className:"col-lg-6",children:Object(i.jsxs)("div",{className:"input-group",children:[Object(i.jsx)("input",{onChange:function(e){l(e.target.value);var n=function(e,t){return t=t.toLowerCase(),e.filter((function(e,r){return e.title.toLowerCase().includes(t)}))}(r,e.target.value);t(n)},value:o,type:"text",className:"form-control",placeholder:"Search for...",required:!0}),Object(i.jsx)("span",{className:"input-group-btn",children:Object(i.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Go!"})})]})})})},R=function(e){var t=e.token,r=Object(c.useState)([]),n=Object(s.a)(r,2),a=n[0],o=n[1],l=Object(c.useState)([]),u=Object(s.a)(l,2),h=u[0],d=u[1],O=Object(T.e)();return console.log(t),Object(c.useEffect)(Object(j.a)(p.a.mark((function e(){var r,n,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=10;break}return e.next=4,x(t);case 4:r=e.sent,console.log("user data is",r),n=r.data.posts,s=r.data.messages,o(n),d(s);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("trouble",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),[]),Object(i.jsxs)("div",{className:"container",children:[Object(i.jsx)("h1",{className:"text-center",children:"Your Current Postings"}),Object(i.jsx)("br",{}),Object(i.jsx)("div",{children:a.map((function(e,r){return Object(i.jsxs)("div",{className:"containter",children:[Object(i.jsx)("h2",{className:"list-group-item-heading text-danger",children:e.title}),Object(i.jsxs)("div",{className:"list-group-item-info",children:["User ID: ",e.author]}),Object(i.jsxs)("div",{className:"bg-success",children:["Description: ",e.description]}),Object(i.jsxs)("div",{className:"bg-success list-group-item-text",children:["Location: ",e.location]}),Object(i.jsxs)("div",{className:"list-group-item-text bg-success text-danger",children:["Price: ",e.price]}),Object(i.jsxs)("div",{className:"bg-success list-group-item-text",children:["Will Deliver: ",e.willDeliver]}),e.active?Object(i.jsxs)("div",{className:"bg-success list-group-item-text",children:["POST IS CURRENTLY ACTIVE ",e.active]}):null,e.active?Object(i.jsx)("div",{className:"form-group",children:Object(i.jsx)("button",{onClick:function(){var r=Object(j.a)(p.a.mark((function r(n){var s;return p.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,m(t,e._id);case 3:s=r.sent,console.log(s),b(a),O.push("/posts"),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),console.error("trouble deleting post",r.t0);case 12:case"end":return r.stop()}}),r,null,[[0,9]])})));return function(e){return r.apply(this,arguments)}}(),type:"submit",className:"btn btn-primary",children:"Delete Post"})}):null]},r)}))}),Object(i.jsx)("h1",{className:"text-center",children:"Your Current Messages"}),Object(i.jsx)("br",{}),h.map((function(e,t){return Object(i.jsxs)("div",{className:"container",children:[Object(i.jsx)("h2",{className:"list-group-item-heading text-danger",children:"Message"}),Object(i.jsxs)("div",{className:"list-group-item-info",children:["Message about: ",e.post.title]}),Object(i.jsxs)("div",{className:"list-group-item-info",children:["From: ",e.fromUser.username]}),Object(i.jsxs)("div",{className:"bg-success list-group-item-text",children:["Content: ",e.content]})]},t)}))]})},B=function(){var e=Object(c.useState)(null),t=Object(s.a)(e,2),r=t[0],a=t[1],o=Object(c.useState)([]),u=Object(s.a)(o,2),p=u[0],j=u[1];return Object(c.useEffect)((function(){var e=localStorage.getItem("token");e&&(a(e),v(e),g(e))}),[]),Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(l,{}),Object(i.jsx)("br",{}),Object(i.jsxs)(N.a,{children:[r?Object(i.jsx)(N.b,{to:"/profile",children:"Profile "}):Object(i.jsx)(N.b,{to:"/login",children:" Login "}),r?null:Object(i.jsx)(N.b,{to:"/register",children:" Register"}),Object(i.jsx)(N.b,{to:"/posts",children:" Posts "}),r?Object(i.jsx)(N.b,{to:"/newpost",children:"Make new post "}):null,r?Object(i.jsx)(N.b,{to:"/logout",children:"Log out "}):null,Object(i.jsx)(T.a,{path:"/login",render:function(e){return Object(i.jsx)(y,Object(n.a)(Object(n.a)({},e),{},{setToken:a}))}}),Object(i.jsx)(T.a,{path:"/register",render:function(e){return Object(i.jsx)(k,Object(n.a)(Object(n.a)({},e),{},{setToken:a}))}}),Object(i.jsx)(T.a,{path:"/posts",render:function(e){return Object(i.jsx)(C,Object(n.a)(Object(n.a)({},e),{},{posts:p,setPosts:j,isLoggedIn:!!r,token:r}))}}),Object(i.jsx)(T.a,{path:"/newpost",render:function(e){return Object(i.jsx)(P,Object(n.a)(Object(n.a)({},e),{},{posts:p,setPosts:j,token:r}))}}),Object(i.jsx)(T.a,{path:"/profile",render:function(e){return Object(i.jsx)(R,Object(n.a)(Object(n.a)({},e),{},{token:r}))}}),Object(i.jsx)(T.a,{path:"/logout",render:function(e){return Object(i.jsx)(w,Object(n.a)(Object(n.a)({},e),{},{setToken:a,token:r}))}}),Object(i.jsx)(T.a,{path:"/message",render:function(e){return Object(i.jsx)(D,Object(n.a)(Object(n.a)({},e),{},{token:r,posts:p}))}}),Object(i.jsx)(T.a,{path:"/search",render:function(e){return Object(i.jsx)(E,Object(n.a)(Object(n.a)({},e),{},{token:r,posts:p}))}})]})]})};o.a.render(Object(i.jsx)(B,{}),document.getElementById("app"))}},[[35,1,2]]]);
//# sourceMappingURL=main.01da3b71.chunk.js.map